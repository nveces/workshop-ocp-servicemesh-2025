<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lab 6 - Istio Control Plane :: WorkShop - Service Mesh on OCP 2025</title>
    <link rel="canonical" href="https://nveces.github.io/workshop-ocp-servicemesh-2025/workshop-ocp-servicemesh-2025/service-mesh-envoy-and-istio-control-plane/06-crtlplane.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="https://nveces.github.io/workshop-ocp-servicemesh-2025">WorkShop - Service Mesh on OCP 2025</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Books</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">CheatSheets</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">CheatSheet A</a>
            <a class="navbar-item" href="#">CheatSheet B</a>
            <a class="navbar-item" href="#">CheatSheet C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Upcoming Events</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Event A</a>
            <a class="navbar-item" href="#">Event B</a>
            <a class="navbar-item" href="#">Event C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Tutorial A</a>
            <a class="navbar-item" href="#">Tutorial B</a>
            <a class="navbar-item" href="#">Tutorial C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="workshop-ocp-servicemesh-2025" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">WorkShop - Service Mesh on OCP 2025</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../01-setup.html">1. Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../01-setup.html#prerequisite">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../01-setup.html#minikube">Setup Minikube</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../02-deploy.html">2. Deploy Service</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../02-deploy.html#package">Build Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../02-deploy.html#deploy">Deploy Dervice</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../introduction/index.html">3. Introduction - Labs</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/index.html#_lab_0_warming_up">Lab 0 - Warming up</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/index.html#_lab_1_first_application_deployment">Lab 1 - First application deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">WorkShop - Service Mesh on OCP 2025</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">WorkShop - Service Mesh on OCP 2025</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">WorkShop - Service Mesh on OCP 2025</a></li>
    <li><a href="06-crtlplane.html">Lab 6 - Istio Control Plane</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/nveces/workshop-ocp-servicemesh-2025/edit/master/documentation/modules/ROOT/pages/service-mesh-envoy-and-istio-control-plane/06-crtlplane.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Lab 6 - Istio Control Plane</h1>
<div id="toc" class="toc">
<div id="toctitle">Istio Control Plane</div>
<ul class="sectlevel1">
<li><a href="#review">1. Review consequences of adding a new project to Istio Control Plane</a>
<ul class="sectlevel2">
<li><a href="#smr">1.1. Create <em>ServiceMeshMember</em> Object</a></li>
<li><a href="#np">1.2. Review Network Policies Created</a></li>
</ul>
</li>
<li><a href="#06test">2. Test <em>Jump App</em></a>
<ul class="sectlevel2">
<li><a href="#up">2.1. Confirm <em>Jump App</em> is running again</a></li>
<li><a href="#06kiali">2.2. Visit Kiali</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Let the Instructor know that you are at this point
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>At this moment, you are not able to access to <em>Jump App</em> because of a set of required tasks which you have to perform next.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="review"><a class="anchor" href="#review"></a>1. Review consequences of adding a new project to Istio Control Plane</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Istio, the <em>ServiceMeshMemberRoll</em> lists the projects belonging to the control plane and only projects listed in the ServiceMeshMemberRoll are affected by the control plane.</p>
</div>
<div class="paragraph">
<p>When a service mesh user who doesnâ€™t have privileges would like to add members to the <em>ServiceMeshMemberRoll</em>, Istio provides an object names <em>ServiceMeshMember</em> which adds a selected project to the <em>ServiceMeshMemberRoll</em> within the control plane project that it references.</p>
</div>
<div class="paragraph">
<p>Once a new project is added to the Service Mesh Control Plane, it is automatically provided with a set of new Kubernetes objects in order to restring and control the communications flow inside this namespace by Istio.</p>
</div>
<div class="paragraph">
<p>In this step, you have to be able to add this namespace in the Service Mesh Control Plane and understand the implications of this procedure.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Please, replace <strong>&lt;user_namespace&gt;</strong> with the value provided by the Instructor at the beginning of this tutorial.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="smr"><a class="anchor" href="#smr"></a>1.1. Create <em>ServiceMeshMember</em> Object</h3>
<div class="paragraph">
<p>First of all, it is required to create a new <em>ServiceMeshMember</em> object for being able to add a new project to the Service Mesh.</p>
</div>
<div class="paragraph">
<p>Please, create the previous object through the respective Openshift template executing the following command:</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/service-mesh-envoy-and-istio-control-plane/06-crtlplane.adoc - include::partials/oc_process_apply.adoc[]</p>
</div>
<div class="paragraph">
<div class="title"><em>ServiceMeshMember</em> Created</div>
<p><span class="image unresolved"><img src="jump-app-ns-smr.png" alt="jump app ns smr"></span></p>
</div>
<div class="paragraph">
<p>Additionally, you are able to check this new object through the Openshift Console:</p>
</div>
<div class="paragraph">
<div class="title"><em>ServiceMeshMember</em> Created Console- 1</div>
<p><span class="image unresolved"><img src="jump-app-ns-smr-con1.png" alt="jump app ns smr con1"></span>
.<em>ServiceMeshMember</em> Created Console - 2
<span class="image unresolved"><img src="jump-app-ns-smr-con2.png" alt="jump app ns smr con2"></span>
.<em>ServiceMeshMember</em> Created Console - 3
<span class="image unresolved"><img src="jump-app-ns-smr-con3.png" alt="jump app ns smr con3"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="np"><a class="anchor" href="#np"></a>1.2. Review Network Policies Created</h3>
<div class="paragraph">
<p>In a cluster using a Kubernetes Container Network Interface (CNI) plug-in that supports Kubernetes network policy, network isolation is controlled entirely by NetworkPolicy objects.  In OpenShift Container Platform, OpenShift SDN supports using network policy in its default network isolation mode.</p>
</div>
<div class="paragraph">
<p>By default, all pods in a project are accessible from other pods and network endpoints. However, once a new project is added to the Service Mesh Control Plane, Istio creates a set of <em>NetworkPolicy</em> objects in that project to indicate the allowed incoming connections within the mesh.</p>
</div>
<div class="paragraph">
<p>In order to display the new network policies objects, please execute the following command:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-input hljs" data-lang="input">oc get networkpolicies -n &lt;user_namespace&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><em>NetworkPolicies</em> Created Project</div>
<p><span class="image unresolved"><img src="jump-app-ns-smr-np.png" alt="jump app ns smr np"></span></p>
</div>
<div class="paragraph">
<p>Then, you should review the first network policy in order to understand why external traffic flow is allowed through Istio Gateway to Jump App pods which are exposed by a <em>Gateway</em> Object:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-input hljs" data-lang="input">oc get networkpolicy istio-expose-route-basic -o yaml -n &lt;user_namespace&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><em>NetworkPolicies</em> Created Project</div>
<p><span class="image unresolved"><img src="jump-app-ns-smr-np-1.png" alt="jump app ns smr np 1"></span></p>
</div>
<div class="paragraph">
<p>Finally, the second network policy allows internal Service Mesh traffic through any pod included in a project inside the Service Mesh Control Plane installed in <em>istio-system</em> namespace:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-input hljs" data-lang="input">oc get networkpolicy istio-mesh-basic -o yaml -n &lt;user_namespace&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><em>NetworkPolicies</em> Created Project</div>
<p><span class="image unresolved"><img src="jump-app-ns-smr-np-2.png" alt="jump app ns smr np 2"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="06test"><a class="anchor" href="#06test"></a>2. Test <em>Jump App</em></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="up"><a class="anchor" href="#up"></a>2.1. Confirm <em>Jump App</em> is running again</h3>
<div class="paragraph">
<p>Once your project has been added to the Service Mesh Control Plane, it is required to follow the next steps in order to ensure your demo app is running properly:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Look at the number of containers in each microservice, it must contains 2 container per each pod (<strong>READY 2/2</strong>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/service-mesh-envoy-and-istio-control-plane/06-crtlplane.adoc - include::partials/check_jumpapp_mesh.adoc[]</p>
</div>
</div>
<div class="sect2">
<h3 id="06kiali"><a class="anchor" href="#06kiali"></a>2.2. Visit Kiali</h3>
<div class="paragraph">
<p>Jump App is generating traffic flow thanks to the frontend where was defined an specific number of continuous jumps. In order to review the Service Mesh traffic flow in your project, please visit Kiali console <strong>&lt;kiali_url&gt;</strong> (<em>E.g. <a href="https://kiali-istio-system.apps.tutorialrhmesh.sandbox507.opentlc.com" class="bare">https://kiali-istio-system.apps.tutorialrhmesh.sandbox507.opentlc.com</a></em>):</p>
</div>
<div class="paragraph">
<div class="title">Kiali Console</div>
<p><span class="image unresolved"><img src="jump-app-kiali-v2.png" alt="jump app kiali v2"></span></p>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
